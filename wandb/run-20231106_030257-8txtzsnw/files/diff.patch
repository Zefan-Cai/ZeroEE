diff --git a/open_instruct/eval/ace/__pycache__/run_eval.cpython-39.pyc b/open_instruct/eval/ace/__pycache__/run_eval.cpython-39.pyc
index 21ee6b8..271bcff 100644
Binary files a/open_instruct/eval/ace/__pycache__/run_eval.cpython-39.pyc and b/open_instruct/eval/ace/__pycache__/run_eval.cpython-39.pyc differ
diff --git a/open_instruct/open_instruct/__pycache__/llama_flash_attn_monkey_patch.cpython-38.pyc b/open_instruct/open_instruct/__pycache__/llama_flash_attn_monkey_patch.cpython-38.pyc
index 003357f..91a8a34 100644
Binary files a/open_instruct/open_instruct/__pycache__/llama_flash_attn_monkey_patch.cpython-38.pyc and b/open_instruct/open_instruct/__pycache__/llama_flash_attn_monkey_patch.cpython-38.pyc differ
diff --git a/scripts/PKU_finetune_GenData_Val.sh b/scripts/PKU_finetune_GenData_Val.sh
index e1c6654..0d38a3e 100644
--- a/scripts/PKU_finetune_GenData_Val.sh
+++ b/scripts/PKU_finetune_GenData_Val.sh
@@ -1,17 +1,17 @@
-export CUDA_VISIBLE_DEVICES=4,5
+export CUDA_VISIBLE_DEVICES=4,5,6,7
 
 MODEL_PATH="/home/models/Llama-2-7b-hf/"
 OUTPUT_NAME=Llama2_GenData_1definitions_v2/
-TRAIN_FILE="/home/caizf/projects/ZeroEE/data/generated_data/train_1definitions.json"
+TRAIN_FILE="/home/caizf/projects/ZeroEE/data/generated_data/train_1definitions_100.json"
 VAL_FILE="/home/caizf/projects/ZeroEE/data/generated_data/val_1definitions.json"
 TEST_FILE="/home/caizf/projects/ZeroEE/data/ace_v2/ACE_valid_GenerationStyle_trigger.json"
 REPORT_TAGS="CtrlGen"
 
 # ceildiv(){ echo $((($1+$2-1)/$2)); }
 # NUM_GPUS=$(ceildiv ${#CUDA_VISIBLE_DEVICES} 2)
-NUM_GPUS=2
+NUM_GPUS=4
 BATCH_SIZE_PER_GPU=1
-TOTAL_BATCH_SIZE=2
+TOTAL_BATCH_SIZE=4
 GRADIENT_ACC_STEPS=$(($TOTAL_BATCH_SIZE/$NUM_GPUS/$BATCH_SIZE_PER_GPU))
 echo "Training model ${MODEL_PATH} using $NUM_GPUS GPUs, $BATCH_SIZE_PER_GPU batch size per GPU, $GRADIENT_ACC_STEPS gradient accumulation steps"
 
@@ -28,8 +28,8 @@ accelerate launch \
     --tokenizer_name $MODEL_PATH \
     --use_slow_tokenizer \
     --train_file $TRAIN_FILE \
-    --val_file $VAL_FILE \
-    --test_file $TEST_FILE \
+    --val_file $TEST_FILE \
+    --test_file $VAL_FILE \
     --max_seq_length 256 \
     --preprocessing_num_workers 16 \
     --per_device_train_batch_size $BATCH_SIZE_PER_GPU \
@@ -45,6 +45,6 @@ accelerate launch \
     --report_to wandb \
     --report_name $OUTPUT_NAME \
     --report_tags $REPORT_TAGS \
-    --eval_steps 400 \
+    --eval_steps 4 \
     --checkpointing_steps epoch \
     --logging_steps 1
\ No newline at end of file
diff --git a/scripts/pku_generated_training_data_1definitions.py b/scripts/pku_generated_training_data_1definitions.py
index 6228412..5754231 100644
--- a/scripts/pku_generated_training_data_1definitions.py
+++ b/scripts/pku_generated_training_data_1definitions.py
@@ -23,7 +23,7 @@ error_num = 0
 print(f"debug number of parents: {len(list(data.keys()))}")
 
 val_parent_list = list(data.keys())[:100]
-train_parent_list = list(data.keys())[100:]
+train_parent_list = list(data.keys())[100:200]
 
 
 
@@ -110,7 +110,7 @@ for parent_event in train_parent_list:
                             # "parent": parent_event,
                             # "events": events,
                             # "sons": sons,
-                            "prompt": f"SENTENCE: {sentence} \n EVENT TYPE: {event_name}. \n DEFINITION: {event_definition} \n PARENT: {parent_event}, SON: {text_sons}. \n So what is the trigger?",
+                            "prompt": f"SENTENCE: {negative_sample} \n EVENT TYPE: {event_name}. \n DEFINITION: {event_definition} \n PARENT: {parent_event}, SON: {text_sons}. \n So what is the trigger?",
                             "completion": f"Event trigger is <trigger>."
                             })
         else:
@@ -122,7 +122,7 @@ print(f"debug error_num {str(error_num)}")
 
 train_data =  positive_train_data + negative_train_data
 
-with open(os.path.join(output_dir, 'generated_data', 'train_1definitions.json'), 'w') as fp:
+with open(os.path.join(output_dir, 'generated_data', 'train_1definitions_100.json'), 'w') as fp:
     for line in tqdm(train_data):
         json.dump(line, fp)
         fp.write('\n')
@@ -219,7 +219,7 @@ for parent_event in val_parent_list:
                             # "parent": parent_event,
                             # "events": events,
                             # "sons": sons,
-                            "prompt": f"SENTENCE: {sentence} \n EVENT TYPE: {event_name}. \n DEFINITION: {event_definition} \n PARENT: {parent_event}, SON: {text_sons}. \n So what is the trigger?",
+                            "prompt": f"SENTENCE: {negative_sample} \n EVENT TYPE: {event_name}. \n DEFINITION: {event_definition} \n PARENT: {parent_event}, SON: {text_sons}. \n So what is the trigger?",
                             "completion": f"Event trigger is ",
                             "trigger":  "<trigger>"
                             })
diff --git a/wandb/debug-cli.caizf.log b/wandb/debug-cli.caizf.log
index e69de29..dd61673 100644
--- a/wandb/debug-cli.caizf.log
+++ b/wandb/debug-cli.caizf.log
@@ -0,0 +1,18 @@
+2023-11-06 02:41:37 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:41:38 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:41:38 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:41:38 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:41:38 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:41:39 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:11 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:11 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:12 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:12 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:12 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:42:13 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:07 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:08 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:08 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:08 WARNING Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:08 WARNING Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
+2023-11-06 02:44:08 WARNING Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLZeroReturnError(6, 'TLS/SSL connection has been closed (EOF) (_ssl.c:1131)')': /api/4504800232407040/envelope/
diff --git a/wandb/debug-internal.log b/wandb/debug-internal.log
index da0a5ca..37f018d 120000
--- a/wandb/debug-internal.log
+++ b/wandb/debug-internal.log
@@ -1 +1 @@
-run-20231105_231424-6mtowpzv/logs/debug-internal.log
\ No newline at end of file
+run-20231106_030257-8txtzsnw/logs/debug-internal.log
\ No newline at end of file
diff --git a/wandb/debug.log b/wandb/debug.log
index e9e0865..c5a82ba 120000
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1 +1 @@
-run-20231105_231424-6mtowpzv/logs/debug.log
\ No newline at end of file
+run-20231106_030257-8txtzsnw/logs/debug.log
\ No newline at end of file
diff --git a/wandb/latest-run b/wandb/latest-run
index f7667d3..4b0d41a 120000
--- a/wandb/latest-run
+++ b/wandb/latest-run
@@ -1 +1 @@
-run-20231105_231424-6mtowpzv
\ No newline at end of file
+run-20231106_030257-8txtzsnw
\ No newline at end of file
