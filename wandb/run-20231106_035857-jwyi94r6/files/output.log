11/06/2023 03:59:00 - INFO - __main__ - ***** Running training *****
11/06/2023 03:59:00 - INFO - __main__ -   Num examples = 151736
11/06/2023 03:59:00 - INFO - __main__ -   Num Epochs = 20
11/06/2023 03:59:00 - INFO - __main__ -   Instantaneous batch size per device = 16
11/06/2023 03:59:00 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 96
11/06/2023 03:59:00 - INFO - __main__ -   Gradient Accumulation steps = 1
11/06/2023 03:59:00 - INFO - __main__ -   Total optimization steps = 31620
  0%|                                                                                                                                                                         | 0/31620 [00:00<?, ?it/s]11/06/2023 03:59:00 - INFO - accelerate.accelerator - Loading states from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5
11/06/2023 03:59:00 - INFO - accelerate.accelerator - Loading DeepSpeed Model and Optimizer
Resumed from checkpoint: /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5
[2023-11-06 03:59:00,100] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-11-06 03:59:00,112] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-11-06 03:59:00,113] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2023-11-06 03:59:00,124] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2023-11-06 03:59:00,133] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2023-11-06 03:59:03,946] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2023-11-06 03:59:03,947] [INFO] [engine.py:2865:_get_all_zero_checkpoint_state_dicts] successfully read 6 ZeRO state_dicts for rank 0
11/06/2023 03:59:07 - INFO - accelerate.accelerator - DeepSpeed Model and Optimizer loaded from input dir /local1/zefan/output/Llama2_GenData_1definitions_top200/epoch_5/pytorch_model
11/06/2023 03:59:07 - INFO - accelerate.checkpointing - All model weights loaded successfully
11/06/2023 03:59:07 - INFO - accelerate.checkpointing - All optimizer states loaded successfully
11/06/2023 03:59:07 - INFO - accelerate.checkpointing - All scheduler states loaded successfully
11/06/2023 03:59:07 - INFO - accelerate.checkpointing - All random states loaded successfully
11/06/2023 03:59:07 - INFO - accelerate.accelerator - Loading in 0 custom states
 30%|██████████████████████████████████████████████▊                                                                                                             | 9486/31620 [00:07<00:16, 1343.52it/s]

 30%|██████████████████████████████████████████████▊                                                                                                             | 9486/31620 [00:07<00:16, 1343.52it/s]11/06/2023 03:59:11 - INFO - __main__ -   Step: 9487, LR: 1.4431001684874179e-05, Loss: 0.004177939146757126
11/06/2023 03:59:15 - INFO - __main__ -   Step: 9488, LR: 1.4430349475514975e-05, Loss: 0.000276626436971128
11/06/2023 03:59:16 - INFO - __main__ - Start doing evaluation at step: 9488
  0%|                                                                                                                                                                             | 0/4 [00:00<?, ?it/s]

 25%|█████████████████████████████████████████▎                                                                                                                           | 1/4 [00:04<00:13,  4.56s/it]

 50%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 2/4 [00:08<00:08,  4.25s/it]

 75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                         | 3/4 [00:13<00:04,  4.38s/it]
torch.Size([256, 150, 32004]) torch.Size([256, 150])
debug ground_truth [16387, 10943, 10548, 16387, 443, 10943, 14831, 16387, 10943, 10548]
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/local1/ponienkung/miniconda3/envs/tulu/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
11/06/2023 03:59:33 - INFO - __main__ -  [Validation] Step: 9488, Scores: {"val_Accuracy": 0.0, "val_Positive_Precision": 0.0, "val_Positive_Recall": 0.0, "val_Positive_F1": 0.0, "val_Negative_Precision": 0.0, "val_Negative_Recall": 0.0, "val_Negative_F1": 0.0}
11/06/2023 03:59:33 - INFO - __main__ - Start doing evaluation at step: 9488




