2023-11-06 03:07:22,063 INFO    StreamThr :82791 [internal.py:wandb_internal():86] W&B internal server running at pid: 82791, started at: 2023-11-06 03:07:22.061891
2023-11-06 03:07:22,065 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: status
2023-11-06 03:07:22,067 INFO    WriterThread:82791 [datastore.py:open_for_write():85] open: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/run-4a8wiknb.wandb
2023-11-06 03:07:22,068 DEBUG   SenderThread:82791 [sender.py:send():379] send: header
2023-11-06 03:07:22,117 DEBUG   SenderThread:82791 [sender.py:send():379] send: run
2023-11-06 03:07:22,798 INFO    SenderThread:82791 [dir_watcher.py:__init__():211] watching files in: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files
2023-11-06 03:07:22,798 INFO    SenderThread:82791 [sender.py:_start_run_threads():1121] run started: 4a8wiknb with start time 1699211242.060794
2023-11-06 03:07:22,816 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: check_version
2023-11-06 03:07:22,817 DEBUG   SenderThread:82791 [sender.py:send_request():406] send_request: check_version
2023-11-06 03:07:23,637 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: run_start
2023-11-06 03:07:23,641 DEBUG   HandlerThread:82791 [system_info.py:__init__():32] System info init
2023-11-06 03:07:23,641 DEBUG   HandlerThread:82791 [system_info.py:__init__():47] System info init done
2023-11-06 03:07:23,641 INFO    HandlerThread:82791 [system_monitor.py:start():181] Starting system monitor
2023-11-06 03:07:23,641 INFO    SystemMonitor:82791 [system_monitor.py:_start():145] Starting system asset monitoring threads
2023-11-06 03:07:23,642 INFO    HandlerThread:82791 [system_monitor.py:probe():201] Collecting system info
2023-11-06 03:07:23,643 INFO    SystemMonitor:82791 [interfaces.py:start():190] Started cpu monitoring
2023-11-06 03:07:23,644 INFO    SystemMonitor:82791 [interfaces.py:start():190] Started disk monitoring
2023-11-06 03:07:23,645 INFO    SystemMonitor:82791 [interfaces.py:start():190] Started gpu monitoring
2023-11-06 03:07:23,646 INFO    SystemMonitor:82791 [interfaces.py:start():190] Started memory monitoring
2023-11-06 03:07:23,650 INFO    SystemMonitor:82791 [interfaces.py:start():190] Started network monitoring
2023-11-06 03:07:23,721 DEBUG   HandlerThread:82791 [system_info.py:probe():196] Probing system
2023-11-06 03:07:23,727 DEBUG   HandlerThread:82791 [system_info.py:_probe_git():181] Probing git
2023-11-06 03:07:23,741 DEBUG   HandlerThread:82791 [system_info.py:_probe_git():189] Probing git done
2023-11-06 03:07:23,742 DEBUG   HandlerThread:82791 [system_info.py:probe():244] Probing system done
2023-11-06 03:07:23,742 DEBUG   HandlerThread:82791 [system_monitor.py:probe():210] {'os': 'Linux-5.4.0-150-generic-x86_64-with-glibc2.17', 'python': '3.8.17', 'heartbeatAt': '2023-11-05T19:07:23.722012', 'startedAt': '2023-11-05T19:07:22.053731', 'docker': None, 'cuda': None, 'args': ('--model_name_or_path', '/home/models/Llama-2-7b-hf/', '--use_flash_attn', '--tokenizer_name', '/home/models/Llama-2-7b-hf/', '--use_slow_tokenizer', '--train_file', '/home/caizf/projects/ZeroEE/data/generated_data/train_1definitions_100.json', '--val_file', '/home/caizf/projects/ZeroEE/data/ace_v2/ACE_valid_GenerationStyle_trigger.json', '--test_file', '/home/caizf/projects/ZeroEE/data/generated_data/val_1definitions.json', '--max_seq_length', '256', '--preprocessing_num_workers', '16', '--per_device_train_batch_size', '1', '--per_device_eval_batch_size', '32', '--gradient_accumulation_steps', '1', '--learning_rate', '2e-5', '--lr_scheduler_type', 'linear', '--warmup_ratio', '0.03', '--weight_decay', '0.', '--num_train_epochs', '2', '--output_dir', '/home/caizf/projects/ZeroEE/output/Llama2_GenData_1definitions_v2/', '--with_tracking', '--report_to', 'wandb', '--report_name', 'Llama2_GenData_1definitions_v2/', '--report_tags', 'CtrlGen', '--eval_steps', '4', '--checkpointing_steps', 'epoch', '--logging_steps', '1'), 'state': 'running', 'program': './open_instruct/open_instruct/finetune_val.py', 'codePathLocal': 'open_instruct/open_instruct/finetune_val.py', 'codePath': 'open_instruct/open_instruct/finetune_val.py', 'git': {'remote': 'https://github.com/Zefan-Cai/ZeroEE', 'commit': 'b8f3a121e03e2b5063ca3dea1e7bfd1b844b3352'}, 'email': '972281745@qq.com', 'root': '/home/caizf/projects/ZeroEE/ZeroEE', 'host': 'user-R8428-G12', 'username': 'caizf', 'executable': '/home/caizf/miniconda3/envs/tulu/bin/python', 'cpu_count': 48, 'cpu_count_logical': 96, 'cpu_freq': {'current': 2070.326697916668, 'min': 800.0, 'max': 3500.0}, 'cpu_freq_per_core': [{'current': 858.202, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 1362.103, 'min': 800.0, 'max': 3500.0}, {'current': 3346.029, 'min': 800.0, 'max': 3500.0}, {'current': 1042.892, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3343.242, 'min': 800.0, 'max': 3500.0}, {'current': 3344.666, 'min': 800.0, 'max': 3500.0}, {'current': 3344.506, 'min': 800.0, 'max': 3500.0}, {'current': 800.973, 'min': 800.0, 'max': 3500.0}, {'current': 3343.804, 'min': 800.0, 'max': 3500.0}, {'current': 3343.279, 'min': 800.0, 'max': 3500.0}, {'current': 2800.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.501, 'min': 800.0, 'max': 3500.0}, {'current': 801.045, 'min': 800.0, 'max': 3500.0}, {'current': 2168.965, 'min': 800.0, 'max': 3500.0}, {'current': 873.471, 'min': 800.0, 'max': 3500.0}, {'current': 799.378, 'min': 800.0, 'max': 3500.0}, {'current': 3335.866, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 1690.622, 'min': 800.0, 'max': 3500.0}, {'current': 3324.283, 'min': 800.0, 'max': 3500.0}, {'current': 3324.108, 'min': 800.0, 'max': 3500.0}, {'current': 955.841, 'min': 800.0, 'max': 3500.0}, {'current': 3353.275, 'min': 800.0, 'max': 3500.0}, {'current': 3313.638, 'min': 800.0, 'max': 3500.0}, {'current': 3353.125, 'min': 800.0, 'max': 3500.0}, {'current': 3311.366, 'min': 800.0, 'max': 3500.0}, {'current': 904.248, 'min': 800.0, 'max': 3500.0}, {'current': 3311.896, 'min': 800.0, 'max': 3500.0}, {'current': 3311.678, 'min': 800.0, 'max': 3500.0}, {'current': 852.837, 'min': 800.0, 'max': 3500.0}, {'current': 3310.766, 'min': 800.0, 'max': 3500.0}, {'current': 842.686, 'min': 800.0, 'max': 3500.0}, {'current': 3308.96, 'min': 800.0, 'max': 3500.0}, {'current': 3308.25, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3362.119, 'min': 800.0, 'max': 3500.0}, {'current': 2799.886, 'min': 800.0, 'max': 3500.0}, {'current': 3369.366, 'min': 800.0, 'max': 3500.0}, {'current': 799.334, 'min': 800.0, 'max': 3500.0}, {'current': 800.556, 'min': 800.0, 'max': 3500.0}, {'current': 800.249, 'min': 800.0, 'max': 3500.0}, {'current': 1563.197, 'min': 800.0, 'max': 3500.0}, {'current': 3301.236, 'min': 800.0, 'max': 3500.0}, {'current': 800.56, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 1060.298, 'min': 800.0, 'max': 3500.0}, {'current': 885.987, 'min': 800.0, 'max': 3500.0}, {'current': 799.004, 'min': 800.0, 'max': 3500.0}, {'current': 1307.506, 'min': 800.0, 'max': 3500.0}, {'current': 3362.984, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3304.106, 'min': 800.0, 'max': 3500.0}, {'current': 3367.156, 'min': 800.0, 'max': 3500.0}, {'current': 3362.025, 'min': 800.0, 'max': 3500.0}, {'current': 798.98, 'min': 800.0, 'max': 3500.0}, {'current': 3365.49, 'min': 800.0, 'max': 3500.0}, {'current': 3350.776, 'min': 800.0, 'max': 3500.0}, {'current': 2805.982, 'min': 800.0, 'max': 3500.0}, {'current': 800.618, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3292.448, 'min': 800.0, 'max': 3500.0}, {'current': 900.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3334.079, 'min': 800.0, 'max': 3500.0}, {'current': 800.712, 'min': 800.0, 'max': 3500.0}, {'current': 1732.619, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.936, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 1162.868, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 855.268, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 835.497, 'min': 800.0, 'max': 3500.0}, {'current': 3295.312, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3299.996, 'min': 800.0, 'max': 3500.0}, {'current': 2800.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.872, 'min': 800.0, 'max': 3500.0}, {'current': 3306.309, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 3254.765, 'min': 800.0, 'max': 3500.0}, {'current': 3300.0, 'min': 800.0, 'max': 3500.0}, {'current': 800.0, 'min': 800.0, 'max': 3500.0}, {'current': 1747.413, 'min': 800.0, 'max': 3500.0}, {'current': 800.902, 'min': 800.0, 'max': 3500.0}], 'disk': {'/': {'total': 816.0403480529785, 'used': 196.288330078125}}, 'gpu': 'NVIDIA A40', 'gpu_count': 8, 'gpu_devices': [{'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}, {'name': 'NVIDIA A40', 'memory_total': 47850782720}], 'memory': {'total': 503.5498466491699}}
2023-11-06 03:07:23,742 INFO    HandlerThread:82791 [system_monitor.py:probe():211] Finished collecting system info
2023-11-06 03:07:23,742 INFO    HandlerThread:82791 [system_monitor.py:probe():214] Publishing system info
2023-11-06 03:07:23,742 DEBUG   HandlerThread:82791 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2023-11-06 03:07:23,742 DEBUG   HandlerThread:82791 [system_info.py:_save_pip():68] Saving pip packages done
2023-11-06 03:07:23,742 DEBUG   HandlerThread:82791 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2023-11-06 03:07:23,802 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/requirements.txt
2023-11-06 03:07:23,803 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/conda-environment.yaml
2023-11-06 03:07:25,983 DEBUG   HandlerThread:82791 [system_info.py:_save_conda():87] Saving conda packages done
2023-11-06 03:07:25,983 DEBUG   HandlerThread:82791 [system_info.py:_save_code():90] Saving code
2023-11-06 03:07:25,994 DEBUG   HandlerThread:82791 [system_info.py:_save_code():111] Saving code done
2023-11-06 03:07:25,995 DEBUG   HandlerThread:82791 [system_info.py:_save_patches():128] Saving git patches
2023-11-06 03:07:26,059 DEBUG   HandlerThread:82791 [system_info.py:_save_patches():170] Saving git patches done
2023-11-06 03:07:26,061 INFO    HandlerThread:82791 [system_monitor.py:probe():216] Finished publishing system info
2023-11-06 03:07:26,064 DEBUG   SenderThread:82791 [sender.py:send():379] send: files
2023-11-06 03:07:26,064 INFO    SenderThread:82791 [sender.py:_save_file():1375] saving file wandb-metadata.json with policy now
2023-11-06 03:07:26,064 INFO    SenderThread:82791 [sender.py:_save_file():1375] saving file code/open_instruct/open_instruct/finetune_val.py with policy now
2023-11-06 03:07:26,064 INFO    SenderThread:82791 [sender.py:_save_file():1375] saving file diff.patch with policy now
2023-11-06 03:07:26,078 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: stop_status
2023-11-06 03:07:26,079 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: internal_messages
2023-11-06 03:07:26,081 DEBUG   SenderThread:82791 [sender.py:send_request():406] send_request: stop_status
2023-11-06 03:07:26,552 DEBUG   SenderThread:82791 [sender.py:send():379] send: telemetry
2023-11-06 03:07:26,552 DEBUG   SenderThread:82791 [sender.py:send():379] send: config
2023-11-06 03:07:26,800 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/conda-environment.yaml
2023-11-06 03:07:26,801 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/wandb-metadata.json
2023-11-06 03:07:26,801 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/diff.patch
2023-11-06 03:07:26,802 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/code/open_instruct/open_instruct/finetune_val.py
2023-11-06 03:07:26,802 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/output.log
2023-11-06 03:07:26,803 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/code
2023-11-06 03:07:26,803 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/code/open_instruct/open_instruct
2023-11-06 03:07:26,803 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_created():271] file/dir created: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/code/open_instruct
2023-11-06 03:07:27,077 INFO    wandb-upload_0:82791 [upload_job.py:push():131] Uploaded file /tmp/tmpedq6lhsmwandb/cox2o7d5-wandb-metadata.json
2023-11-06 03:07:27,182 INFO    wandb-upload_2:82791 [upload_job.py:push():131] Uploaded file /tmp/tmpedq6lhsmwandb/1gbpov7c-diff.patch
2023-11-06 03:07:27,278 INFO    wandb-upload_1:82791 [upload_job.py:push():131] Uploaded file /tmp/tmpedq6lhsmwandb/lqbtalab-code/open_instruct/open_instruct/finetune_val.py
2023-11-06 03:07:27,555 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: status_report
2023-11-06 03:07:28,802 INFO    Thread-12 :82791 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/caizf/projects/ZeroEE/ZeroEE/wandb/run-20231106_030722-4a8wiknb/files/output.log
2023-11-06 03:07:32,557 DEBUG   HandlerThread:82791 [handler.py:handle_request():144] handle_request: status_report
2023-11-06 03:07:33,668 INFO    cpu       :82791 [interfaces.py:monitor():140] Process cpu has exited.
2023-11-06 03:07:33,669 DEBUG   SystemMonitor:82791 [system_monitor.py:_start():159] Starting system metrics aggregation loop
2023-11-06 03:07:33,670 DEBUG   SystemMonitor:82791 [system_monitor.py:_start():166] Finished system metrics aggregation loop
2023-11-06 03:07:33,670 DEBUG   SystemMonitor:82791 [system_monitor.py:_start():170] Publishing last batch of metrics
2023-11-06 03:07:33,675 INFO    memory    :82791 [interfaces.py:monitor():140] Process proc.memory.rssMB has exited.
2023-11-06 03:07:33,676 DEBUG   SenderThread:82791 [sender.py:send():379] send: stats
2023-11-06 03:07:34,641 INFO    MainThread:82791 [internal.py:handle_exit():76] Internal process exited
